(("undefined"!==typeof self?self:this)["webpackJsonpfhir_data_tool"]=("undefined"!==typeof self?self:this)["webpackJsonpfhir_data_tool"]||[]).push([[3],{"27a6":function(e){e.exports=JSON.parse("{}")},"56e7":function(e,t,n){},"836c":function(e,t,n){},"960b":function(e,t,n){},bc13b:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-page"},[n("p",[e._v("Home")]),n("FhirForm",{staticClass:"fhir-form"}),n("ResourceContainer")],1)},r=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fhir-form"},[n("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[n("EndpointSelector"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.mrn,expression:"mrn"}],attrs:{type:"text",name:"mrn"},domProps:{value:e.mrn},on:{input:function(t){t.target.composing||(e.mrn=t.target.value)}}}),n(e.endpointForm,{tag:"component"}),n("button",{attrs:{type:"submit"}},[e._v("submit")])],1),n("button",{on:{click:e.onCleanClick}},[e._v("clean results")])])},i=[],o=(n("96cf"),n("3b8d")),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.endpoint,expression:"endpoint"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.endpoint=t.target.multiple?n:n[0]}}},[n("option",{attrs:{disabled:"",value:""}},[e._v("Please select an endpoint...")]),e._l(e.endpoints,(function(t,a){return n("option",{key:a,domProps:{value:t,textContent:e._s(t)}})}))],2)])},u=[],l=n("7eac"),d={name:"EndpointSelector",data:function(){return{}},computed:{endpoints:function(){return l["a"]},endpoint:{get:function(){return this.$store.state.endpoint.current},set:function(e){this.setEndpoint(e)}}},methods:{setEndpoint:function(e){this.$store.dispatch("endpoint/setEndpoint",e)}}},p=d,h=n("2877"),v=Object(h["a"])(p,c,u,!1,null,"787572e2",null),f=v.exports,b={name:"FhirForm",components:{EndpointSelector:f},data:function(){return{}},computed:{mrn:{get:function(){return this.$store.state.endpoint.mrn},set:function(e){this.$store.dispatch("endpoint/setMRN",e)}},endpointForm:function(){var e=null,t=this.$store.state.endpoint.current;switch(t){case"Condition":e=null;break;case"MedicationOrder":e=function(){return n.e(6).then(n.bind(null,"5991"))};break;case"Observation":e=function(){return n.e(7).then(n.bind(null,"6175"))};break;default:break}return e}},methods:{onSubmit:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$store.state.endpoint.current,n=this.$store.state.endpoint.mrn,a=this.$store.state.endpoint.params,r=a[t]||[],e.prev=4,e.next=7,this.$store.dispatch("resource/fetchResource",{endpoint:t,mrn:n,params:r});case 7:s=e.sent,this.$store.dispatch("resource/setResource",{resource:s}),i=[s],this.$store.dispatch("resource/setResources",{resources:i}),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](4),console.error(e.t0);case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));function t(){return e.apply(this,arguments)}return t}(),onCleanClick:function(){var e=[],t={};this.$store.dispatch("resource/setResource",{resource:t}),this.$store.dispatch("resource/setResources",{resources:e})}}},m=b,y=(n("cb04"),Object(h["a"])(m,s,i,!1,null,"15a998fa",null)),g=y.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"resource-container"}},[n(e.resource_table,e._b({tag:"component"},"component",e.resource_table_props,!1)),n("ResourceRawData",{attrs:{raw_data:e.source}}),n("button",{on:{click:e.onClick}},[e._v("extract")])],1)},k=[],O=(n("8e6e"),n("456d"),n("6b54"),n("7f7f"),n("75fc")),j=n("bd86"),C=(n("ac6a"),n("cadf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("details",[n("summary",[e._v("source")]),n("JsonObject",{attrs:{value:e.raw_data}}),n("button",{on:{click:e.copyData}},[e._v("copy")])],1)])}),w=[],$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"json",class:{collapsed:e.collapsed,activeValue:e.activeValue}},[e.showKey?n("div",{staticClass:"key",class:{active:e.activeKey},attrs:{title:e.path},on:{click:function(t){return e.onKeyClick(e.key_name,t)}}},[e._v('"'+e._s(e.key_name)+'":')]):e._e(),"object"===typeof e.value?[n("div",{staticClass:"parenthesis"},[e._v(e._s("array"===e.type?"[":"{"))]),n("div",{staticClass:"children-toggler",on:{click:e.toggleChildren}},[e._v("â–¶")]),e.valueIsEmpty?e._e():[e.collapsed?n("div",{staticClass:"ellipsis",on:{click:e.toggleChildren}},[e._v("...")]):n("div",{staticClass:"node"},e._l(e.value,(function(t,a){return n("div",{key:a,staticClass:"item"},[n("JsonObject",{attrs:{key_name:a,value:t,depth:e.depth+1}})],1)})),0)],n("div",{staticClass:"parenthesis"},[e._v(e._s("array"===e.type?"]":"}"))])]:[n("div",{staticClass:"value",class:{active:e.activeValue},on:{click:function(t){return e.onValueClick(e.value,t)}}},[e._v('"'+e._s(e.value)+'"')])]],2)},R=[],E=n("7618"),x=(n("c5f6"),n("8bbf")),D=n.n(x),S=new D.a,P={name:"JsonObject",data:function(){return{collapsed:!1,activeValue:!1,activeKey:!1}},props:{depth:{type:Number,default:0},value:{default:null},key_name:{type:[String,Number],default:null}},created:function(){var e=this;S.$on("keyClicked",(function(t,n){var a=n.shiftKey;e.setActiveKey(t,a)})),S.$on("valueClicked",(function(t,n){var a=n.shiftKey;e.setActiveValue(t,a)}))},computed:{type:function(){return"object"!==Object(E["a"])(this.value)?Object(E["a"])(this.value):Array.isArray(this.value)?"array":"object"},path:function(){if(null!==this.key_name){var e=[this.key_name],t=this.$parent;while(t.$options.name===this.$options.name)null!==t.key_name&&e.push(t.key_name),t=t.$parent;return e.reverse()}},valueIsEmpty:function(){var e=this.value;return"object"===Object(E["a"])(e)?Array.isArray(e)?e.length<1:Object.keys(e).length<1:!e},isObject:function(){return"object"===Object(E["a"])(this.value)&&!Array.isArray(this.value)},showKey:function(){return this.$parent.isObject}},methods:{setActiveKey:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._uid===e._uid?this.activeKey=!this.activeKey:t||(this.activeKey=!1)},setActiveValue:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._uid===e._uid?this.activeValue=!this.activeValue:t||(this.activeValue=!1)},toggleChildren:function(){this.collapsed=!this.collapsed},onKeyClick:function(e,t){S.$emit("keyClicked",this,t),console.log(e,this.path)},onValueClick:function(e,t){S.$emit("valueClicked",this,t),console.log({value:e,path:this.path})}}},V=P,A=(n("c4f8"),Object(h["a"])(V,$,R,!1,null,"4bec9790",null)),K=A.exports,F={name:"ResourceRawData",components:{JsonObject:K},props:{raw_data:{type:Object,default:function(){return{}}}},methods:{onKeyClick:function(e){var t=e.key,n=e.path;console.log(arguments),this.$store.dispatch("mappings/setKey",{key:t,path:n})},onValueClick:function(e){var t=e.value,n=e.path;console.log(arguments),this.$store.dispatch("mappings/setValues",{value:t,path:n})},prettify:function(e){var t=JSON.stringify(e,null,2);return t},copyToClipboard:function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t);var n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);t.select(),document.execCommand("copy"),document.body.removeChild(t),n&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n))},copyData:function(){var e=this.prettify(this.raw_data);this.copyToClipboard(e),alert("copied!")}}},J=F,T=(n("f9cb"),Object(h["a"])(J,C,w,!1,null,"6c5b9c20",null)),N=T.exports,B=n("d225"),H=n("b0b4"),I=(n("4917"),n("3b2b"),function(){function e(t){var n=t.system,a=void 0===n?"":n,r=t.code,s=void 0===r?"":r,i=t.display,o=void 0===i?"":i;Object(B["a"])(this,e),this.system=a,this.code=s,this.display=o}return Object(H["a"])(e,[{key:"isSystem",value:function(e){if("RegExp"==typeof e);else new RegExp(e,"i");return this.system.match(regExp)}}]),e}()),M=I,Q=n("08da"),z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(B["a"])(this,e),this.source=t}return Object(H["a"])(e,[{key:"search",value:function(){return Q["search"].apply(void 0,arguments)}},{key:"codings",get:function(){var e=this.source.code.coding,t=void 0===e?[]:e,n=t.map((function(e){return new M(e)}));return n}}]),e}(),q=z,G=(n("386d"),n("308d")),L=n("6bb5"),U=n("4e2b"),W=n("619d"),X=n("013f"),Y=n("2ef0"),Z=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(B["a"])(this,t),e=Object(G["a"])(this,Object(L["a"])(t).call(this,n)),Object(j["a"])(Object(X["a"])(e),"value_keys",["valueQuantity","valueCodeableConcept","valueString","valueRange","valueRatio","valueSampledData","valueAttachment","valueTime","valueDateTime","valuePeriod"]),e}return Object(U["a"])(t,e),Object(H["a"])(t,[{key:"getValue",value:function(e){var t=Object.keys(e),n=Object(Y["intersection"])(t,this.value_keys),a=n[0]||"",r=new ee(a,e);return r}},{key:"date",get:function(){var e=this.source.effectiveDateTime;if(!e)return"";var t=new Date(e);return t}},{key:"display",get:function(){this.codings}},{key:"values",get:function(){var e=this,t=this.source.component;if(t){var n=t.map((function(t){return e.getValue(t)}));return n}var a=this.getValue(this.source);return[a]}}]),t}(q),ee=function(e){function t(e,n){var a;return Object(B["a"])(this,t),a=Object(G["a"])(this,Object(L["a"])(t).call(this,n)),a.type=e,a}return Object(U["a"])(t,e),Object(H["a"])(t,[{key:"toString",value:function(){return this.text_value}},{key:"value",get:function(){if(this.type)return this.source[this.type]}},{key:"display",get:function(){var e=this.source.code.text,t=void 0===e?"":e,n=this.codings.map((function(e){var t=e.display,n=void 0===t?"":t;return n}));return n&&n.length>0?n[0]:t}},{key:"text_value",get:function(){var e=this.type;if(!e)return"";var t="",n=this.value;switch(e){case"valueQuantity":t=n.value;break;case"valueCodeableConcept":t=n.text;break;case"valueRange":var a=[],r=n.low,s=void 0===r?"":r,i=n.high,o=void 0===i?"":i;s&&a.push(s),o&&a.push(o),t=a.join(", ");break;case"valueRatio":try{t=n.numerator/n.denominator}catch(d){t=d}break;case"valueSampledData":t=n.data;break;case"valueAttachment":t=n.title;break;case"valuePeriod":var c=n.start,u=n.end;t="from ".concat(c," to ").concat(u);break;case"valueTime":case"valueDateTime":case"valueString":t=n;break;default:var l=[];for(key in n)Object(W["a"])("properties"),l="".concat(key,": ").concat(n[key]);t=l.join(", ");break}return t}}]),t}(q),te=Z,ne=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(B["a"])(this,t),Object(G["a"])(this,Object(L["a"])(t).call(this,e))}return Object(U["a"])(t,e),Object(H["a"])(t,[{key:"entries",get:function(){var e=this.search(this.source,"entry"),t=[];return e.forEach((function(e){var n=e.resource,a=e.resource.resourceType;switch(a){case"Observation":var r=new te(n);t.push(r);break;default:break}})),t}},{key:"codings",get:function(){var e=this.search({foo:{bar:{baz:[0,1,2,3,4]}}},"foo.bar");return e}}]),t}(q),ae=ne;n("27a6"),n("fa1f");function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(n,!0).forEach((function(t){Object(j["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie={name:"resource-container",components:{ResourceRawData:N},data:function(){return{resource_table:null,resource_table_props:{}}},props:{data:{type:Object}},watch:{source:function(){this.renderData()}},computed:{endpoint:function(){var e=this.$store.state.endpoint.current;return e},resource:function(){var e=this.$store.state.resource.resource,t=void 0===e?{}:e;return t},source:function(){try{var e=this.resource.metadata.source,t=void 0===e?{}:e;return t}catch(n){return{}}}},methods:{renderData:function(){try{var e=this.source,t=e.resourceType;switch(t){case"Bundle":this.renderObservationBundleData();break;case"Patient":this.renderPatientData();break;default:break}}catch(n){console.log(n)}},renderObservationBundleData:function(){var e=this,t=new ae(this.source),a=t.entries,r=[];a.forEach((function(t,n){var a=e.getRowsFromEntry(t),s=a.map((function(e){return se({},e,{_group:n})}));r.push.apply(r,Object(O["a"])(s))}));var s={code:"Code",system:"System",display:"Description (from EHR, not from REDCap mapping)",value:"Value",date:"Date/time of service"};this.resource_table=function(){return n.e(0).then(n.bind(null,"9def6"))},this.resource_table_props={rows:r,headers:s}},renderPatientData:function(){var e=this.resource.data,t={first_name:"first name",last_name:"last name",gender:"gender",gender_code:"gender code",ethnicity:"ethnicity",ethnicity_code:"ethnicity code",race:"race",race_code:"race code",birthdate:"birthdate",address_city:"address city",address_country:"address country",address_postal_code:"address postal code",address_state:"address state",address_line:"address line",phone_home:"phone home",phone_mobile:"phone mobile",email:"email",is_deceased:"is deceased"};this.resource_table_props={rows:[e],headers:t},this.resource_table=function(){return n.e(0).then(n.bind(null,"9def6"))}},getRowsFromEntry:function(e){var t=e.constructor.name,n=[];switch(t){case"Observation":var a=e.date,r=e.values;r.forEach((function(e){var t=e.codings;if(0==t.length){var r={date:a,display:e.display,value:e.toString()};n.push(r)}else t.forEach((function(t){var r=t.code,s=t.display,i=t.system,o={date:a,code:r,display:s,system:i,value:e.toString()};n.push(o)}))}));break;default:break}return n},onClick:function(){}}},oe=ie,ce=Object(h["a"])(oe,_,k,!1,null,"a25fb8ee",null),ue=ce.exports,le={name:"HomePage",components:{FhirForm:g,ResourceContainer:ue},props:{msg:String},methods:{},computed:{}},de=le,pe=(n("cd9b"),Object(h["a"])(de,a,r,!1,null,"5dd90c88",null));t["default"]=pe.exports},c4f8:function(e,t,n){"use strict";var a=n("836c"),r=n.n(a);r.a},cb04:function(e,t,n){"use strict";var a=n("dc9a"),r=n.n(a);r.a},cd9b:function(e,t,n){"use strict";var a=n("960b"),r=n.n(a);r.a},dc9a:function(e,t,n){},f9cb:function(e,t,n){"use strict";var a=n("56e7"),r=n.n(a);r.a},fa1f:function(e){e.exports=JSON.parse("{}")}}]);
//# sourceMappingURL=fhir_data_tool.umd.min.3.js.map